<!DOCTYPE html>
<html class="light" lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="icon.png" />
    <title>Inventário</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap"
        rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/app.js"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "nb-yellow": "#FFD23F",
                        "nb-purple": "#C596F8",
                        "nb-pink": "#FF85B3",
                        "nb-blue": "#5EBCF7",
                        "nb-green": "#85E0A3",
                        "nb-orange": "#FF9F45",
                        "nb-red": "#FF5252",
                        "nb-gray": "#9CA3AF",
                        "nb-white": "#FFFFFF",
                        "nb-black": "#000000",
                        "nb-bg": "#F3F0E9",
                        "primary": "#6366F1",
                        "accent-yellow": "#FFDE59",
                        "accent-blue": "#7FBCF5",
                        "accent-green": "#C6E875",
                        "accent-pink": "#FFAFCC",
                        "accent-orange": "#FFAD7A",
                        "background-light": "#F8FAFC",
                        "background-dark": "#101022",
                        "card-dark": "#1E1E2E",
                        "dark-border": "#000000",
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#1E1E1E",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "0.75rem",
                        "xl": "1rem",
                        "2xl": "1.25rem",
                        "3xl": "1.5rem",
                        "full": "9999px",
                        "nb": "12px",
                        "brutal": "12px",
                    },
                    boxShadow: {
                        "neo": "4px 4px 0px 0px #000000",
                        "neo-hover": "2px 2px 0px 0px #000000",
                        "neo-sm": "2px 2px 0px 0px #000000",
                        "neo-lg": "8px 8px 0px 0px #000000",
                        "hard": "4px 4px 0px 0px #000000",
                        "hard-sm": "2px 2px 0px 0px #000000",
                        "hard-lg": "6px 6px 0px 0px #000000",
                    },
                    borderWidth: {
                        '3': '3px',
                        '4': '4px',
                    }
                },
            },
        }
    </script>
</head>

<body class="bg-nb-bg font-display text-nb-black overflow-hidden h-screen w-full flex flex-col">
    <div
        class="h-full flex flex-col w-full max-w-full md:max-w-2xl mx-auto bg-nb-bg md:border-x-2 border-nb-black shadow-none md:shadow-hard-lg relative z-10 overflow-hidden">

        <!-- App Header (Fixed) -->
        <header id="app-header"
            class="fixed top-0 w-full max-w-2xl z-50 flex items-center justify-between px-5 pt-6 pb-4 bg-white dark:bg-card-dark border-b-2 border-black transition-all duration-300">
            <button onclick="navigate('usuario.html')"
                class="flex size-10 items-center justify-center rounded-lg bg-white dark:bg-card-dark shadow-neo text-slate-900 dark:text-white hover:bg-slate-50 transition-all active:shadow-none active:translate-x-1 active:translate-y-1 border-2 border-black">
                <span class="material-symbols-outlined font-bold">arrow_back</span>
            </button>
            <h1
                class="text-xl font-extrabold text-slate-900 dark:text-white tracking-tight flex-1 text-center uppercase">
                Inventário</h1>
            <div class="flex items-center gap-2">
                <button onclick="openAddModal()"
                    class="flex size-10 items-center justify-center rounded-lg bg-nb-yellow border-2 border-nb-black shadow-neo text-nb-black hover:bg-yellow-400 transition-all active:shadow-none active:translate-x-1 active:translate-y-1">
                    <span class="material-symbols-outlined font-bold">add</span>
                </button>
                <button onclick="navigate('assistente.html')"
                    class="flex size-10 items-center justify-center rounded-lg bg-black text-white border-2 border-black shadow-neo hover:bg-gray-800 transition-all active:shadow-none active:translate-x-1 active:translate-y-1">
                    <span class="material-symbols-outlined font-bold">auto_awesome</span>
                </button>
            </div>
        </header>

        <!-- Main Content (Dynamic & Scrollable) -->
        <main id="main-content" class="flex-1 flex flex-col relative overflow-y-auto no-scrollbar pt-24 pb-24 transition-all duration-300">
            <div class="flex-1 px-5 pt-2 pb-6 space-y-6">
                <section class="space-y-4">
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10">
                            <span class="material-symbols-outlined text-black font-bold">search</span>
                        </div>
                        <input id="searchInput"
                            class="block w-full pl-10 pr-3 py-4 border-2 border-black rounded-xl text-slate-900 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary focus:border-black shadow-neo font-bold bg-white dark:bg-card-dark text-lg"
                            placeholder="Buscar no estoque..." type="text" />
                    </div>
                    <div id="filterContainer" class="flex gap-3 overflow-x-auto pb-2 no-scrollbar">
                        <button data-cat="all"
                            class="filter-btn active flex-none px-5 py-2.5 bg-white dark:bg-card-dark text-slate-900 dark:text-white border-2 border-black rounded-lg shadow-neo-sm active:translate-y-0.5 active:shadow-none transition-all font-bold text-sm tracking-wide uppercase hover:bg-slate-50">
                            Tudo
                        </button>
                        <button data-cat="Comida"
                            class="filter-btn flex-none px-5 py-2.5 bg-white dark:bg-card-dark text-slate-900 dark:text-white border-2 border-black rounded-lg shadow-neo-sm active:translate-y-0.5 active:shadow-none transition-all font-bold text-sm tracking-wide uppercase hover:bg-slate-50">
                            Comida
                        </button>
                        <button data-cat="Limpeza"
                            class="filter-btn flex-none px-5 py-2.5 bg-white dark:bg-card-dark text-slate-900 dark:text-white border-2 border-black rounded-lg shadow-neo-sm active:translate-y-0.5 active:shadow-none transition-all font-bold text-sm tracking-wide uppercase hover:bg-slate-50">
                            Limpeza
                        </button>
                        <button data-cat="Higiene"
                            class="filter-btn flex-none px-5 py-2.5 bg-white dark:bg-card-dark text-slate-900 dark:text-white border-2 border-black rounded-lg shadow-neo-sm active:translate-y-0.5 active:shadow-none transition-all font-bold text-sm tracking-wide uppercase hover:bg-slate-50">
                            Higiene
                        </button>
                    </div>
                </section>

                <section id="statsSection" class="flex flex-col gap-4">
                    <div
                        class="w-full bg-primary-light dark:bg-primary-dark/20 p-5 rounded-xl border-2 border-black shadow-neo flex items-center justify-between">
                        <div>
                            <p
                                class="text-xs font-black uppercase tracking-widest text-primary-dark dark:text-primary-light mb-1">
                                Itens em casa</p>
                            <h2 id="totalCount" class="text-4xl font-extrabold text-black dark:text-white">--</h2>
                        </div>
                        <div
                            class="size-14 bg-white dark:bg-card-dark rounded-full border-2 border-black flex items-center justify-center rotate-3 hover:rotate-0 transition-transform">
                            <span class="material-symbols-outlined text-3xl font-black text-primary">inventory_2</span>
                        </div>
                    </div>

                    <div id="loading" class="hidden flex justify-center p-8">
                        <div class="size-10 border-4 border-black border-t-transparent rounded-full animate-spin"></div>
                    </div>

                    <div id="itemsList" class="flex flex-col gap-4">
                        <!-- Items will be injected here -->
                    </div>
                </section>
            </div>

            <!-- Add Item Modal (Inside Main for scoping, but fixed position handles visual) -->
            <div id="addItemModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4">
                <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeAddModal()"></div>
                <div
                    class="bg-nb-white w-full max-w-md rounded-nb border-2 border-nb-black shadow-hard p-6 relative z-10 animate-up">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-black uppercase tracking-tight">Novo Item</h2>
                        <button onclick="closeAddModal()"
                            class="size-8 flex items-center justify-center rounded-full hover:bg-gray-100">
                            <span class="material-symbols-outlined font-bold">close</span>
                        </button>
                    </div>

                    <form id="addItemForm" onsubmit="handleAddItem(event)" class="flex flex-col gap-4">
                        <div>
                            <label class="text-xs font-bold uppercase tracking-wider mb-1 block">Nome do Item</label>
                            <input type="text" name="name" required placeholder="Ex: Arroz"
                                class="w-full bg-nb-bg border-2 border-nb-black rounded-lg p-3 font-bold focus:outline-none focus:shadow-neo transition-all">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold uppercase tracking-wider mb-1 block">Quantidade</label>
                                <input type="number" name="quantity" required value="1" min="1"
                                    class="w-full bg-nb-bg border-2 border-nb-black rounded-lg p-3 font-bold focus:outline-none focus:shadow-neo transition-all">
                            </div>
                            <div>
                                <label class="text-xs font-bold uppercase tracking-wider mb-1 block">Unidade</label>
                                <select name="unit"
                                    class="w-full bg-nb-bg border-2 border-nb-black rounded-lg p-3 font-bold focus:outline-none focus:shadow-neo transition-all appearance-none">
                                    <option value="unid.">Unid.</option>
                                    <option value="kg">Kg</option>
                                    <option value="g">g</option>
                                    <option value="L">L</option>
                                    <option value="ml">ml</option>
                                    <option value="pct">Pct</option>
                                    <option value="cx">Cx</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="text-xs font-bold uppercase tracking-wider mb-1 block">Categoria</label>
                            <div class="grid grid-cols-2 gap-2">
                                <label class="cursor-pointer">
                                    <input type="radio" name="category" value="Comida" checked class="peer hidden">
                                    <div
                                        class="border-2 border-nb-black rounded-lg p-2 text-center text-sm font-bold bg-white peer-checked:bg-nb-yellow peer-checked:shadow-neo-sm transition-all hover:bg-gray-50">
                                        Comida
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="category" value="Limpeza" class="peer hidden">
                                    <div
                                        class="border-2 border-nb-black rounded-lg p-2 text-center text-sm font-bold bg-white peer-checked:bg-nb-blue peer-checked:shadow-neo-sm transition-all hover:bg-gray-50">
                                        Limpeza
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="category" value="Higiene" class="peer hidden">
                                    <div
                                        class="border-2 border-nb-black rounded-lg p-2 text-center text-sm font-bold bg-white peer-checked:bg-nb-green peer-checked:shadow-neo-sm transition-all hover:bg-gray-50">
                                        Higiene
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="category" value="Outros" class="peer hidden">
                                    <div
                                        class="border-2 border-nb-black rounded-lg p-2 text-center text-sm font-bold bg-white peer-checked:bg-nb-purple peer-checked:shadow-neo-sm transition-all hover:bg-gray-50">
                                        Outros
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label class="text-xs font-bold uppercase tracking-wider mb-1 block">Data de
                                Inclusão</label>
                            <input type="date" name="added_date" required
                                class="w-full bg-nb-bg border-2 border-nb-black rounded-lg p-3 font-bold focus:outline-none focus:shadow-neo transition-all">
                        </div>

                        <button type="submit"
                            class="mt-2 w-full bg-nb-black text-white p-4 rounded-nb font-black uppercase tracking-widest border-2 border-transparent hover:bg-gray-800 active:scale-[0.98] transition-all">
                            Adicionar ao Estoque
                        </button>
                    </form>
                </div>
            </div>
        </main>

        <!-- Fixed Bottom Navigation Bar -->
        <div class="fixed bottom-0 left-0 w-full z-50 pointer-events-none flex flex-col items-center">
            <div
                class="w-full max-w-2xl bg-white dark:bg-card-dark border-t-2 border-black pointer-events-auto h-20 px-6 flex items-center justify-between shadow-[0_-4px_0_0_rgba(0,0,0,1)] relative transition-none">

                <!-- Left: Lists (Inactive) -->
                <button onclick="navigate('usuario.html')"
                    class="flex flex-col items-center gap-1 opacity-40 hover:opacity-100 transition-opacity duration-200 w-16">
                    <span
                        class="material-symbols-outlined text-3xl font-bold text-black dark:text-white">list_alt</span>
                    <span
                        class="text-[10px] font-bold uppercase tracking-wide text-black dark:text-white">Listas</span>
                </button>

                <!-- Center: FAB (Floating) -->
                <div class="absolute left-1/2 -top-8 -translate-x-1/2">
                    <button onclick="openAddModal()"
                        class="size-16 bg-nb-yellow rounded-full border-2 border-black shadow-neo flex items-center justify-center hover:scale-110 active:scale-95 transition-all group">
                        <span
                            class="material-symbols-outlined text-4xl text-black font-black group-hover:rotate-90 transition-transform">add</span>
                    </button>
                </div>

                <!-- Right: Inventory (Active) -->
                <button onclick="navigate('inventario.html')"
                    class="flex flex-col items-center gap-1 opacity-100 w-16 transition-opacity duration-200">
                    <span class="material-symbols-outlined text-3xl font-black text-primary">inventory_2</span>
                    <span class="text-[10px] font-bold uppercase tracking-wide">Estoque</span>
                </button>
            </div>
        </div>
    </div>
</body>

</html>